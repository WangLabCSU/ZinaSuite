---
title: "Visualization Guide"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Visualization Guide}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(ZinaSuite)
library(ggplot2)
```

## Overview

This vignette demonstrates the visualization capabilities of ZinaSuite.

## Visualization Themes

### ZinaSuite Theme

```{r}
# Get the ZinaSuite theme
theme <- theme_zinasuite()
class(theme)

# The theme can be applied to any ggplot
# Example with dummy data
dummy_data <- data.frame(
  x = 1:10,
  y = rnorm(10),
  group = rep(c("A", "B"), each = 5)
)

p <- ggplot(dummy_data, aes(x = x, y = y, color = group)) +
  geom_point(size = 3) +
  theme_zinasuite() +
  labs(title = "Example with ZinaSuite Theme")

print(p)
```

## Color Palettes

### Available Palettes

```{r}
# Get different palettes
nature_palette <- get_palette("nature", n = 5)
print(nature_palette)

# Show palette colors
barplot(rep(1, 5), col = nature_palette, main = "Nature Palette")
```

### Custom Colors

```{r}
# Create custom color scheme
custom_colors <- c("#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2")
print(custom_colors)

# Use in plot
p2 <- ggplot(dummy_data, aes(x = x, y = y, color = group)) +
  geom_point(size = 3) +
  scale_color_manual(values = custom_colors[1:2]) +
  theme_zinasuite()

print(p2)
```

## Basic Plot Types

### Scatter Plots

```{r}
# Create sample correlation data
set.seed(123)
cor_data <- data.frame(
  Gene1 = rnorm(100),
  Gene2 = rnorm(100) + 0.5 * rnorm(100),
  Cancer = sample(c("BRCA", "LUAD", "LUSC"), 100, replace = TRUE)
)

# Basic scatter plot
p_scatter <- ggplot(cor_data, aes(x = Gene1, y = Gene2)) +
  geom_point(alpha = 0.6, color = "steelblue") +
  geom_smooth(method = "lm", color = "red", se = TRUE) +
  theme_zinasuite() +
  labs(
    title = "Gene Correlation Scatter Plot",
    x = "Gene 1 Expression",
    y = "Gene 2 Expression"
  )

print(p_scatter)
```

### Box Plots

```{r}
# Create sample boxplot data
box_data <- data.frame(
  Expression = c(rnorm(50, mean = 5), rnorm(50, mean = 7)),
  Type = rep(c("Tumor", "Normal"), each = 50),
  Cancer = sample(c("BRCA", "LUAD"), 100, replace = TRUE)
)

# Box plot
p_box <- ggplot(box_data, aes(x = Type, y = Expression, fill = Type)) +
  geom_boxplot() +
  scale_fill_manual(values = c("Tumor" = "#E69F00", "Normal" = "#56B4E9")) +
  theme_zinasuite() +
  labs(
    title = "Expression Distribution by Type",
    y = "Expression Level"
  )

print(p_box)
```

### Violin Plots

```{r}
# Violin plot
p_violin <- ggplot(box_data, aes(x = Type, y = Expression, fill = Type)) +
  geom_violin(alpha = 0.7) +
  geom_boxplot(width = 0.1, fill = "white") +
  scale_fill_manual(values = c("Tumor" = "#E69F00", "Normal" = "#56B4E9")) +
  theme_zinasuite() +
  labs(
    title = "Expression Distribution (Violin)",
    y = "Expression Level"
  )

print(p_violin)
```

## Heatmaps

### Correlation Heatmap

```{r}
# Create correlation matrix
genes <- c("TP53", "BRCA1", "EGFR", "MYC", "KRAS")
cor_matrix <- matrix(
  c(1.0, 0.3, 0.5, 0.2, 0.4,
    0.3, 1.0, 0.4, 0.3, 0.2,
    0.5, 0.4, 1.0, 0.6, 0.5,
    0.2, 0.3, 0.6, 1.0, 0.4,
    0.4, 0.2, 0.5, 0.4, 1.0),
  nrow = 5,
  dimnames = list(genes, genes)
)

# Convert to long format for ggplot
cor_long <- data.frame(
  Gene1 = rep(genes, each = 5),
  Gene2 = rep(genes, 5),
  Correlation = as.vector(cor_matrix)
)

# Create heatmap
p_heatmap <- ggplot(cor_long, aes(x = Gene1, y = Gene2, fill = Correlation)) +
  geom_tile() +
  scale_fill_gradient2(
    low = "blue",
    high = "red",
    mid = "white",
    midpoint = 0,
    limits = c(-1, 1)
  ) +
  theme_zinasuite() +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1),
    axis.title = element_blank()
  ) +
  labs(title = "Gene Correlation Matrix")

print(p_heatmap)
```

## Survival Plots

### Kaplan-Meier Style Plot

```{r}
# Create sample survival data
set.seed(123)
surv_data <- data.frame(
  time = rexp(200, rate = 0.1),
  status = sample(0:1, 200, replace = TRUE),
  group = rep(c("High", "Low"), each = 100)
)

# Survival curve approximation using step function
surv_summary <- aggregate(time ~ group, data = surv_data, 
                          FUN = function(x) c(mean = mean(x), median = median(x)))
print(surv_summary)

# Create survival-style plot
p_surv <- ggplot(surv_data, aes(x = time, color = group)) +
  stat_ecdf(geom = "step", size = 1) +
  scale_color_manual(values = c("High" = "#E69F00", "Low" = "#56B4E9")) +
  theme_zinasuite() +
  labs(
    title = "Survival Curve (Example)",
    x = "Time",
    y = "Cumulative Distribution",
    color = "Expression Group"
  )

print(p_surv)
```

## Forest Plots

### Hazard Ratio Plot

```{r}
# Create sample forest plot data
forest_data <- data.frame(
  Gene = c("TP53", "BRCA1", "EGFR", "MYC", "KRAS"),
  HR = c(1.5, 0.8, 1.2, 1.8, 1.1),
  Lower = c(1.2, 0.6, 0.9, 1.4, 0.8),
  Upper = c(1.9, 1.0, 1.6, 2.3, 1.5),
  P_value = c(0.001, 0.05, 0.1, 0.001, 0.2)
)

# Forest plot
p_forest <- ggplot(forest_data, aes(x = HR, y = reorder(Gene, HR))) +
  geom_point(aes(size = -log10(P_value)), color = "steelblue") +
  geom_errorbarh(aes(xmin = Lower, xmax = Upper), height = 0.2) +
  geom_vline(xintercept = 1, linetype = "dashed", color = "red") +
  scale_size_continuous(name = "-log10(p)") +
  theme_zinasuite() +
  labs(
    title = "Hazard Ratio Forest Plot",
    x = "Hazard Ratio",
    y = "Gene"
  )

print(p_forest)
```

## Dimension Reduction Plots

### PCA Plot

```{r}
# Create sample PCA data
set.seed(123)
pca_data <- data.frame(
  PC1 = rnorm(100),
  PC2 = rnorm(100),
  Cancer = sample(c("BRCA", "LUAD", "LUSC", "COAD", "READ"), 100, replace = TRUE),
  Group = sample(c("Tumor", "Normal"), 100, replace = TRUE)
)

# PCA scatter plot
p_pca <- ggplot(pca_data, aes(x = PC1, y = PC2, color = Cancer, shape = Group)) +
  geom_point(size = 3, alpha = 0.7) +
  scale_color_manual(values = get_palette("nature", n = 5)) +
  theme_zinasuite() +
  labs(
    title = "PCA Plot (Example)",
    x = "PC1",
    y = "PC2"
  )

print(p_pca)
```

## Bar Plots

### Grouped Bar Plot

```{r}
# Create sample bar data
bar_data <- data.frame(
  Cancer = rep(c("BRCA", "LUAD", "LUSC", "COAD"), each = 2),
  Type = rep(c("Tumor", "Normal"), 4),
  Mean_Expression = c(7.5, 5.2, 6.8, 4.5, 8.1, 5.8, 7.2, 5.0)
)

# Grouped bar plot
p_bar <- ggplot(bar_data, aes(x = Cancer, y = Mean_Expression, fill = Type)) +
  geom_bar(stat = "identity", position = "dodge") +
  scale_fill_manual(values = c("Tumor" = "#E69F00", "Normal" = "#56B4E9")) +
  theme_zinasuite() +
  labs(
    title = "Mean Expression by Cancer Type",
    y = "Mean Expression"
  )

print(p_bar)
```

## Customization Tips

### Modifying Themes

```{r}
# Custom theme modification
custom_theme <- theme_zinasuite() +
  theme(
    plot.title = element_text(size = 16, face = "bold"),
    axis.text = element_text(size = 12),
    legend.position = "bottom"
  )

p_custom <- ggplot(dummy_data, aes(x = x, y = y, color = group)) +
  geom_point(size = 3) +
  custom_theme +
  labs(title = "Customized Theme Example")

print(p_custom)
```

### Saving Plots

```{r, eval = FALSE}
# Save plots in different formats
ggsave("plot.pdf", plot = p_scatter, width = 8, height = 6)
ggsave("plot.png", plot = p_scatter, width = 8, height = 6, dpi = 300)
ggsave("plot.svg", plot = p_scatter, width = 8, height = 6)
```

## Interactive Plots

### Using plotly

```{r, eval = FALSE}
# Create interactive plot (requires plotly package)
if (requireNamespace("plotly", quietly = TRUE)) {
  p_interactive <- ggplot(cor_data, aes(x = Gene1, y = Gene2, color = Cancer)) +
    geom_point(size = 3, alpha = 0.6) +
    theme_zinasuite() +
    labs(title = "Interactive Correlation Plot")
  
  plotly::ggplotly(p_interactive)
}
```

## Session Information

```{r}
sessionInfo()
```

## Learn More

- `vignette("introduction")` - Package overview
- `vignette("data-query")` - Data querying guide
- `vignette("analysis")` - Statistical analysis methods
- [ggplot2 documentation](https://ggplot2.tidyverse.org/)
